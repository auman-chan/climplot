<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Codes for calculation of climate data • climplot</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Codes for calculation of climate data">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">climplot</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/climplot_Intro.html">Facilitate and tailor Walter &amp; Lieth climatic diagram drawing</a></li>
    <li><a class="dropdown-item" href="../articles/data_calculation.html">Codes for calculation of climate data</a></li>
    <li><a class="dropdown-item" href="../articles/README.zh-CN.html">climplot：用于绘制 Walter &amp; Lieth 气候图的流程化工具</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/auman-chan/climplot/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Codes for calculation of climate data</h1>
                        <h4 data-toc-skip class="author"><a href="https://gitee.com/auman-chan" class="external-link">
Auman Chan, PhD Candidate</a></h4>
            
            <h4 data-toc-skip class="date">2025-02-18</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/auman-chan/climplot/blob/HEAD/vignettes/data_calculation.Rmd" class="external-link"><code>vignettes/data_calculation.Rmd</code></a></small>
      <div class="d-none name"><code>data_calculation.Rmd</code></div>
    </div>

    
    
<style type="text/css">

body {
  margin-top: 16px;
  margin-bottom: 16px;
  font-size: 19px;
  font-weight: 200;
}

#sidebar {
font-size: 16px
}

#sidebar p {
font-size: 16px
}

.contents h1, .contents h2, .contents h3, .contents h4 {
  padding-top: 60px;
  margin-top: -50px;
}

h4 {
  font-size: 19px;
}

h3 {
  font-size: 22px;
}

h2 {
  font-size: 26px;
}

h1 {
  font-size: 30px;
}

pre {
  border: 0;
  overflow-x: auto;
  white-space: pre-wrap;
  white-space: -moz-pre-wrap;
  white-space: -pre-wrap;
  white-space: -o-pre-wrap;
  word-wrap: break-word;
  background: #e9f7ed;
    color: #ffffff;
    padding-top: 0.5em;
  padding-bottom: 0.5em;
  padding-left: 20px;
  padding-right: 20px;
  line-height: 21px;
  font-size: 15px;
}

pre code {
  color: #182125;
}

code {
  word-wrap: break-word;
  font-size: 85%;
  font-family: Consolas,Monaco,"Courier New",monospace;
  border-radius: 0;
}

.nav-pills>li>a {
  border-radius: 0;
}

.navbar-default .navbar-nav>.active>a, .navbar-default .navbar-nav>.active>a:focus, .navbar-default .navbar-nav>.active>a:hover {
  color: #408AB4;
}
.navbar-default .navbar-nav>li>a {
  color: #408AB4;
}

table p {
  font-size: 85%;
}

.ref-index h2 {
  font-size: 24px;
}

h1.title {
  font-weight: bold;
  font-size: 180%;
  text-align: center
}

h2.subtitle {
  font-size: 120%;
  text-align: center
}

h3.subtitle {
  font-size: 120%;
  text-align: center
}

h4.author {
  font-size: 120%;
  text-align: center
}

h4.date {
  font-size: 120%;
  text-align: center
}

p {
  margin-bottom: 30px;
}
</style>
<div class="section level2">
<h2 id="codes-for-climate-data-calculation">Codes for climate data calculation<a class="anchor" aria-label="anchor" href="#codes-for-climate-data-calculation"></a>
</h2>
<p>If you wish to perform the dataset calculations independently, for
example, with other methods or more annual data, please download the
original data and refer to the code provided below. Due to high memory
usage and time requirements, we have refrained from incorporating these
codes as a package function.</p>
<p>The download link of original data as below:</p>
<p><a href="https://geodata.ucdavis.edu/climate/worldclim/2_1/hist/cts4.06/2.5m/wc2.1_cruts4.06_2.5m_tmin_2010-2019.zip" class="external-link">2010-2019
monthly minimum temperature</a></p>
<p><a href="https://geodata.ucdavis.edu/climate/worldclim/2_1/hist/cts4.06/2.5m/wc2.1_cruts4.06_2.5m_tmax_2010-2019.zip" class="external-link">2010-2019
monthly maximum temperature</a></p>
<p><a href="https://geodata.ucdavis.edu/climate/worldclim/2_1/hist/cts4.06/2.5m/wc2.1_cruts4.06_2.5m_prec_2010-2019.zip" class="external-link">2010-2019
monthly precipitation</a></p>
<p>The code for cacluation are as below:</p>
<ul>
<li><p><strong>imp_path</strong>: path of import Worldclim Historical
monthly weather data, every kind of dataset(mintemp,maxtemp,prec)should
be saparated in different folders</p></li>
<li><p><strong>exp_path</strong>: path of export arranged data in format
of .tif</p></li>
<li><p><strong>name</strong>: the name of .tif file to differentiate the
data</p></li>
<li><p><strong>method</strong>: the method for calculating the
raster,default is “mean” to calculate annual average climatic values.
Set as “min” to calculate annual minimum climatic values for forsty
month display.</p></li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Please check whether you have installed these packages</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster" class="external-link">raster</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://had.co.nz/plyr" class="external-link">plyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.apply.futureverse.org" class="external-link">future.apply</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">parallel</span><span class="op">)</span></span>
<span></span>
<span><span class="va">clim_cal</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">imp_path</span>,</span>
<span>                     <span class="va">exp_path</span>,</span>
<span>                     <span class="va">name</span> <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                     <span class="va">method</span> <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>                     <span class="va">parallel</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">tifname</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">imp_path</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">rastermean</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">num</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">tif</span> <span class="op">&lt;-</span> <span class="va">tifname</span><span class="op">[</span><span class="va">tifname</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"-"</span>, <span class="va">num</span>, <span class="st">".tif"</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tif</span>, <span class="va">raster</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/raster/man/brick.html" class="external-link">brick</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/raster/man/calc.html" class="external-link">calc</a></span><span class="op">(</span><span class="va">mean</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">val</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">rastermin</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">num</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">tif</span> <span class="op">&lt;-</span> <span class="va">tifname</span><span class="op">[</span><span class="va">tifname</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"-"</span>, <span class="va">num</span>, <span class="st">".tif"</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">val</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">tif</span>, <span class="va">raster</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/raster/man/brick.html" class="external-link">brick</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/raster/man/calc.html" class="external-link">calc</a></span><span class="op">(</span><span class="va">min</span><span class="op">)</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">val</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multisession</span>, workers <span class="op">=</span> <span class="va">parallel</span><span class="op">)</span></span>
<span>  <span class="va">month</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_pad.html" class="external-link">str_pad</a></span><span class="op">(</span><span class="fl">2</span>, side <span class="op">=</span> <span class="st">"left"</span>, <span class="st">"0"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">method</span> <span class="op">==</span> <span class="st">"mean"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">raster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://future.apply.futureverse.org/reference/future_lapply.html" class="external-link">future_lapply</a></span><span class="op">(</span><span class="va">month</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">rastermean</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">method</span> <span class="op">==</span> <span class="st">"min"</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">raster</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://future.apply.futureverse.org/reference/future_lapply.html" class="external-link">future_lapply</a></span><span class="op">(</span><span class="va">month</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu">rastermin</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">rasterstack</span> <span class="op">&lt;-</span> <span class="va">raster</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/stack.html" class="external-link">stack</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">path</span> <span class="op">&lt;-</span> <span class="va">exp_path</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">ras</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/raster.html" class="external-link">raster</a></span><span class="op">(</span><span class="va">rasterstack</span>, layer <span class="op">=</span> <span class="va">i</span><span class="op">)</span></span>
<span>    <span class="co"># export the RasterLayer</span></span>
<span>    <span class="fu"><a href="https://rspatial.github.io/terra/reference/writeRaster.html" class="external-link">writeRaster</a></span><span class="op">(</span><span class="va">ras</span>, <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="va">path</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">name</span>, <span class="st">"_"</span>, <span class="va">month</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, <span class="st">".tif"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>Then use the code below to extract the data.frames for climatic
diagram plotting:</p>
<ul>
<li><p><strong>file</strong>: A data.frame. It must be the same as the
import data of <code>clim_extract</code> with the five columns(please
refer to the data <code>locdata</code> in this package).</p></li>
<li><p><strong>mintemp_path</strong>: The path of export arranged data
of monthly minimum temperature in format .tif</p></li>
<li><p><strong>maxtemp_path </strong>: The path of export arranged data
of monthly maximum temperature in format .tif</p></li>
<li><p><strong>prec_path</strong>: The path of export arranged data of
monthly precipitation in format .tif</p></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">clim_extract</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">file</span>,<span class="va">mintemp_path</span> <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                         <span class="va">maxtemp_path</span> <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                         <span class="va">prec_path</span> <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">is.numeric</a></span><span class="op">(</span><span class="va">file</span><span class="op">$</span><span class="va">lon</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"The longitude should be numeric"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">is.numeric</a></span><span class="op">(</span><span class="va">file</span><span class="op">$</span><span class="va">lat</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"The latitude should be numeric"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="va">extract_one_location</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sub</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">No</span> <span class="op">&lt;-</span> <span class="va">sub</span><span class="op">$</span><span class="va">No</span></span>
<span>    <span class="va">lon</span> <span class="op">&lt;-</span> <span class="va">sub</span><span class="op">$</span><span class="va">lon</span></span>
<span>    <span class="va">lat</span> <span class="op">&lt;-</span> <span class="va">sub</span><span class="op">$</span><span class="va">lat</span></span>
<span>    </span>
<span>    <span class="va">mintemp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">mintemp_path</span>,full.names <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/stack.html" class="external-link">stack</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="va">maxtemp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">maxtemp_path</span>,full.names <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/stack.html" class="external-link">stack</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="va">avprec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html" class="external-link">list.files</a></span><span class="op">(</span><span class="va">prec_path</span>,full.names <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/raster/man/stack.html" class="external-link">stack</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">mintemp</span><span class="op">)</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">maxtemp</span><span class="op">)</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">avprec</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Can not find data for location"</span>, <span class="va">No</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    </span>
<span>    <span class="va">point</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="va">sub</span>, coords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lon"</span>, <span class="st">"lat"</span><span class="op">)</span>, crs <span class="op">=</span> <span class="fl">4326</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">prec</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/extract.html" class="external-link">extract</a></span><span class="op">(</span><span class="va">avprec</span>, <span class="va">point</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> </span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">prec</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">avtemp1</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/extract.html" class="external-link">extract</a></span><span class="op">(</span><span class="va">mintemp</span>, <span class="va">point</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> </span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">avtemp1</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">avtemp2</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rspatial.github.io/terra/reference/extract.html" class="external-link">extract</a></span><span class="op">(</span><span class="va">maxtemp</span>, <span class="va">point</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>      <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> </span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">avtemp2</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span></span>
<span>    </span>
<span>    </span>
<span>      <span class="va">avtemp3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">avtemp1</span>, <span class="va">avtemp2</span><span class="op">)</span>, <span class="fl">2</span>, <span class="va">mean</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">avtemp1</span> <span class="op">&lt;-</span> <span class="va">avtemp1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>      No <span class="op">=</span> <span class="va">sub</span><span class="op">$</span><span class="va">No</span>,</span>
<span>      Altitude <span class="op">=</span> <span class="va">sub</span><span class="op">$</span><span class="va">altitude</span>,</span>
<span>      Location <span class="op">=</span> <span class="va">sub</span><span class="op">$</span><span class="va">location</span>,</span>
<span>      Lon <span class="op">=</span> <span class="va">sub</span><span class="op">$</span><span class="va">lon</span>,</span>
<span>      Lat <span class="op">=</span> <span class="va">sub</span><span class="op">$</span><span class="va">lat</span>,</span>
<span>      Type <span class="op">=</span> <span class="st">"min_temp"</span>, .before <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">avtemp2</span> <span class="op">&lt;-</span> <span class="va">avtemp2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>      No <span class="op">=</span> <span class="va">sub</span><span class="op">$</span><span class="va">No</span>,</span>
<span>      Altitude <span class="op">=</span> <span class="va">sub</span><span class="op">$</span><span class="va">altitude</span>,</span>
<span>      Location <span class="op">=</span> <span class="va">sub</span><span class="op">$</span><span class="va">location</span>,</span>
<span>      Lon <span class="op">=</span> <span class="va">sub</span><span class="op">$</span><span class="va">lon</span>,</span>
<span>      Lat <span class="op">=</span> <span class="va">sub</span><span class="op">$</span><span class="va">lat</span>,</span>
<span>      Type <span class="op">=</span> <span class="st">"max_temp"</span>, .before <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">avtemp3</span> <span class="op">&lt;-</span> <span class="va">avtemp3</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>      No <span class="op">=</span> <span class="va">sub</span><span class="op">$</span><span class="va">No</span>,</span>
<span>      Altitude <span class="op">=</span> <span class="va">sub</span><span class="op">$</span><span class="va">altitude</span>,</span>
<span>      Location <span class="op">=</span> <span class="va">sub</span><span class="op">$</span><span class="va">location</span>,</span>
<span>      Lon <span class="op">=</span> <span class="va">sub</span><span class="op">$</span><span class="va">lon</span>,</span>
<span>      Lat <span class="op">=</span> <span class="va">sub</span><span class="op">$</span><span class="va">lat</span>,</span>
<span>      Type <span class="op">=</span> <span class="st">"mean_temp"</span>, .before <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">prec</span> <span class="op">&lt;-</span> <span class="va">prec</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>      No <span class="op">=</span> <span class="va">sub</span><span class="op">$</span><span class="va">No</span>,</span>
<span>      Altitude <span class="op">=</span> <span class="va">sub</span><span class="op">$</span><span class="va">altitude</span>,</span>
<span>      Location <span class="op">=</span> <span class="va">sub</span><span class="op">$</span><span class="va">location</span>,</span>
<span>      Lon <span class="op">=</span> <span class="va">sub</span><span class="op">$</span><span class="va">lon</span>,</span>
<span>      Lat <span class="op">=</span> <span class="va">sub</span><span class="op">$</span><span class="va">lat</span>,</span>
<span>      Type <span class="op">=</span> <span class="st">"prec"</span>, .before <span class="op">=</span> <span class="fl">1</span></span>
<span>    <span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">clidata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">prec</span>, <span class="va">avtemp3</span>, <span class="va">avtemp1</span>, <span class="va">avtemp2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/plyr/man/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">No</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">clidata</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  </span>
<span>  </span>
<span>  <span class="va">all_clidata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/plyr/man/ddply.html" class="external-link">ddply</a></span><span class="op">(</span><span class="va">file</span>, <span class="op">~</span><span class="va">No</span>, <span class="va">extract_one_location</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">all_clidata</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level3">
<h3 id="reference">Reference<a class="anchor" aria-label="anchor" href="#reference"></a>
</h3>
<ol style="list-style-type: decimal">
<li><p>Fick, S.E. and R.J. Hijmans, (2017). WorldClim 2: new 1km spatial
resolution climate surfaces for global land areas. International Journal
of Climatology 37 (12): 4302-4315.</p></li>
<li><p>Harris, I., Osborn, T.J., Jones, P.D., Lister, D.H. (2020).
Version 4 of the CRU TS monthly high-resolution gridded multivariate
climate dataset. Scientific Data 7: 109.</p></li>
</ol>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Auman Chan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
